**Exercices d'introduction aux calculs parallèles**

**Exercices avec Python**

(CPE 21/22)

(Version élèves)

Mai 2022

+--------------------+--------------------+--------------------+---+
| > **Table des      | 2                  |                    |   |
| > matières**       |                    |                    |   |
+====================+====================+====================+===+
| I                  | Plan (de ce        | . . . . . . . . .  |   |
|                    | document)          | . . . . . . . . .  |   |
|                    |                    | . . . . . . . . .  |   |
|                    |                    | . . . . . . . . .  |   |
|                    |                    | . . . . .          |   |
+--------------------+--------------------+--------------------+---+
| II                 | > Quelques         | > . . . . . . . .  | 3 |
|                    | > fonctions utiles | > . . . . . . . .  |   |
|                    |                    | > . . . . . . . .  |   |
|                    |                    | > . . . . . . . .  |   |
|                    |                    | > . . . . . . .    |   |
+--------------------+--------------------+--------------------+---+
| > III Exercices à  | . . . . . . . . .  | 4                  |   |
| > réaliser         | . . . . . . . . .  |                    |   |
|                    | . . . . . . . . .  |                    |   |
|                    | . . . . . . . . .  |                    |   |
|                    | . . . . . . .      |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-AExercice :  | 4                  |                    |   |
| > Course Hippique  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . .              |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-A-1Travail à | 7                  |                    |   |
| > réaliser . . . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . .    |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-BExercice :  | . . . . . . . . .  | 8                  |   |
| > faites des       | . . . . . . . . .  |                    |   |
| > calculs          | . . . . . . . . .  |                    |   |
|                    | . . . . . . .      |                    |   |
+--------------------+--------------------+--------------------+---+
| >                  | . . . . . . . . .  | 10                 |   |
|  III-CGestionnaire | . . . . . . . . .  |                    |   |
| > de Billes        | . . . . . . . . .  |                    |   |
|                    | . . . . . . . . .  |                    |   |
|                    | .                  |                    |   |
+--------------------+--------------------+--------------------+---+
| III-DEstimation de | . . . . . . . . .  | 12                 |   |
| PI                 | . . . . . . . . .  |                    |   |
|                    | . . . . . . . . .  |                    |   |
|                    | . . . . . . . . .  |                    |   |
|                    | . . . .            |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-D-1Exemple : | 12                 |                    |   |
| > Calcul de PI par |                    |                    |   |
| > un cercle        |                    |                    |   |
| > unitaire . . . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . .    |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-D-2Principe  | 12                 |                    |   |
| > Hit-Miss (Monte  |                    |                    |   |
| > Carlo) . . . . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . .        |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-EExercice :  | 13                 |                    |   |
| > Estimation       |                    |                    |   |
| > parallèle de Pi  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . .        |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-FExercice :  | . . . . . . . . .  | 14                 |   |
| > Calcul parallèle | . . . . . . . . .  |                    |   |
| > du Merge Sort    | . . . . . . . .    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-F-1Version   | 14                 |                    |   |
| > séquentielle de  |                    |                    |   |
| > base . . . . . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . .      |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-F-2Exercice  | 15                 |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-GExercice :  | 16                 |                    |   |
| > tri-rapide . . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . .          |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-HAutres      | 17                 |                    |   |
| > méthodes de      |                    |                    |   |
| > calcul de PI . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . .        |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-I PI par la  | 17                 |                    |   |
| > méthode          |                    |                    |   |
| > arc-tangente . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . .      |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-J Par la     | 18                 |                    |   |
| > méthode          |                    |                    |   |
| > d'espérance . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| III-KPar la loi    | > . . . . . . . .  | 18                 |   |
| Normale            | > . . . . . . . .  |                    |   |
|                    | > . . . . . . . .  |                    |   |
|                    | > . . . . . . . .  |                    |   |
|                    | > . . . . . . .    |                    |   |
+--------------------+--------------------+--------------------+---+
| >                  | 19                 |                    |   |
| III-LApproximation |                    |                    |   |
| > de PI par les    |                    |                    |   |
| > Aiguilles de     |                    |                    |   |
| > Buffon . . . . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > .                |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-L-1Travail à | 20                 |                    |   |
| > réaliser . . . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . .    |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > III-L-2Addendum  | 22                 |                    |   |
| > aux aiguilles de |                    |                    |   |
| > Buffon . . . . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . .            |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| >                  | 23                 |                    |   |
|  III-L-3Estimation |                    |                    |   |
| > Laplacienne de   |                    |                    |   |
| > pi . . . . . . . |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . . . . .  |                    |                    |   |
| > . . . . .        |                    |                    |   |
+--------------------+--------------------+--------------------+---+
| > **Table des      | **23**             |                    |   |
| > matières**       |                    |                    |   |
+--------------------+--------------------+--------------------+---+

  --
  --

25

Partie 2 : Exercices

Contrôleur de température (& Pression)

Déplacements d'un Robot

Game of Life

CPE - Mai 2022

(Version élèves)

ASG

+-----------------------------------+-----------------------------------+---+
| > Projets CPE : Python Concurrent | \#1                               |   |
+===================================+===================================+===+
| > I                               | I Projets CPE : Python Concurrent |   |
+-----------------------------------+-----------------------------------+---+

> *•* Ce document contient 3 sujets :\
> *◦* Contrôleur de température / Pression\
> *◦* Simulation des déplacements d'un Robot\
> *◦* Simulation des serveurs/client/cuisiniers d'un restaurant*◦* Game
> of life

![](vertopal_ef5244658fc74fe98336a78fff7c2222/media/image4.png){width="1.8888888888888888in"
height="2.2777777777777777in"}

+----------------------------------+----------------------------------+
| > Réalisation d'une système      | \#2                              |
| > muti-tâche de contrôle de      |                                  |
| > Température et Pression        |                                  |
+==================================+==================================+
| > II                             | > Réalisation d'une système      |
|                                  | > muti-tâche de contrôle de      |
|                                  | > Tempéra-                       |
+----------------------------------+----------------------------------+

> ture et Pression

+------------------------------------------------+
| > Difﬁculté : \*\*/\*\*\*\*\* , **(4 points)** |
+------------------------------------------------+

  --
  --

> On considère le système (*temps réel embarqué*) simple suivant :

+-----------+-----------+---------+-------+-----------+-----------+
| *•* Un    | The       |         |       | ![        | >         |
| **        | rmocouple |         |       | ](vertopa |  Capteurs |
| processus |           |         |       | l_ef52446 | >         |
| T** lit   |           |         |       | 58fc74fe9 |  Pression |
| les       |           |         |       | 8336a78ff |           |
| valeurs   |           |         |       | f7c2222/m |           |
| d'un      |           |         |       | edia/imag |           |
| ensemble  |           |         |       | e1.png){w |           |
| de        |           |         |       | idth="0.2 |           |
| ther      |           |         |       | 777777777 |           |
| mocouples |           |         |       | 777778in" |           |
| (par      |           |         |       | hei       |           |
|           |           |         |       | ght="0.11 |           |
|           |           |         |       | 111111111 |           |
|           |           |         |       | 11111in"} |           |
+===========+===========+=========+=======+===========+===========+
| > l'inte  |           |         |       |           |           |
| rmédiaire |           |         |       |           |           |
| > d'un    |           |         |       |           |           |
| > conv    |           |         |       |           |           |
| ertisseur |           |         |       |           |           |
| > ana     |           |         |       |           |           |
| logique-n |           |         |       |           |           |
| umérique, |           |         |       |           |           |
| > CDA).   |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| > ¥ T     |           |         |       |           |           |
| >         |           |         |       |           |           |
|  commande |           |         |       |           |           |
| > les     |           |         |       |           |           |
| > ch      |           |         |       |           |           |
| angements |           |         |       |           |           |
| > a       |           |         |       |           |           |
| ppropriés |           |         |       |           |           |
| > à un    |           |         |       |           |           |
| >         |           |         |       |           |           |
| chauffage |           |         |       |           |           |
| > (par    |           |         |       |           |           |
| > l'in-   |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
|           | ![        |         |       |           |           |
|           | ](vertopa |         |       |           |           |
|           | l_ef52446 |         |       |           |           |
|           | 58fc74fe9 |         |       |           |           |
|           | 8336a78ff |         |       |           |           |
|           | f7c2222/m |         |       |           |           |
|           | edia/imag |         |       |           |           |
|           | e2.png){w |         |       |           |           |
|           | idth="0.3 |         |       |           |           |
|           | 611111111 |         |       |           |           |
|           | 111111in" |         |       |           |           |
|           | heigh     |         |       |           |           |
|           | t="9.7222 |         |       |           |           |
|           | 222222222 |         |       |           |           |
|           | 22e-2in"} |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| > te      |           |         |       |           |           |
| rmédiaire |           |         |       |           |           |
| > d'un    |           |         |       |           |           |
| > co      |           |         |       |           |           |
| mmutateur |           |         |       |           |           |
| > à       |           |         |       |           |           |
| >         |           |         |       |           |           |
|  commande |           |         |       |           |           |
| > nu      |           |         |       |           |           |
| mérique). |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
|           | > **S     | **T**   | **P** | > **Pomp  |           |
|           | witches** |         |       | e/Valve** |           |
+-----------+-----------+---------+-------+-----------+-----------+
| *•* Le    |           |         |       |           |           |
| **        |           |         |       |           |           |
| processus |           |         |       |           |           |
| P** a une |           |         |       |           |           |
| fonction  |           |         |       |           |           |
| similaire |           |         |       |           |           |
| pour la   |           |         |       |           |           |
| pression  |           |         |       |           |           |
| (il       |           |         |       |           |           |
| emploie   |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| > un au   |           |         |       |           |           |
| > conv    |           |         |       |           |           |
| ertisseur |           |         |       |           |           |
| > num     |           |         |       |           |           |
| érique-an |           |         |       |           |           |
| alogique, |           |         |       |           |           |
| > DAC).   |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| *•* T et  |           |         |       |           |           |
| P doivent |           |         |       |           |           |
| co        |           |         |       |           |           |
| mmuniquer |           |         |       |           |           |
| des       |           |         |       |           |           |
| données   |           |         |       |           |           |
| au        |           |         |       |           |           |
| **        |           |         |       |           |           |
| processus |           |         |       |           |           |
| S**, qui  |           |         |       |           |           |
| pré-      |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| > sente   |           | **S**   |       |           |           |
| > des     |           |         |       |           |           |
| > mesures |           |         |       |           |           |
| > à un    |           |         |       |           |           |
| >         |           |         |       |           |           |
| opérateur |           |         |       |           |           |
| > par     |           |         |       |           |           |
| > l'inte  |           |         |       |           |           |
| rmédiaire |           |         |       |           |           |
| > d'un    |           |         |       |           |           |
| > écran.  |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
|           | > ![](    |         |       |           |           |
|           | vertopal_ |         |       |           |           |
|           | ef5244658 |         |       |           |           |
|           | fc74fe983 |         |       |           |           |
|           | 36a78fff7 |         |       |           |           |
|           | c2222/med |         |       |           |           |
|           | ia/image3 |         |       |           |           |
|           | .png){wid |         |       |           |           |
|           | th="9.722 |         |       |           |           |
|           | 222222222 |         |       |           |           |
|           | 222e-2in" |         |       |           |           |
|           | >         |         |       |           |           |
|           |  height=" |         |       |           |           |
|           | 0.375in"} |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| *•* Notez |           |         |       |           |           |
| que P et  |           |         |       |           |           |
| T sont    |           |         |       |           |           |
| les       |           |         |       |           |           |
| entités   |           |         |       |           |           |
| actives ; |           |         |       |           |           |
| S est une |           |         |       |           |           |
| ressource |           |         |       |           |           |
| (il ré-   |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| pond      | > **Ch    | > Ecran | D     |           |           |
| juste aux | auffage** |         |       |           |           |
| demandes  |           |         |       |           |           |
| de T et   |           |         |       |           |           |
| de P) :   |           |         |       |           |           |
| il peut   |           |         |       |           |           |
| être mis  |           |         |       |           |           |
| en        |           |         |       |           |           |
| ap        |           |         |       |           |           |
| plication |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| comme     |           |         |       |           |           |
| ressource |           |         |       |           |           |
| protégée  |           |         |       |           |           |
| ou        |           |         |       |           |           |
| serveur   |           |         |       |           |           |
| s'il agit |           |         |       |           |           |
| plus      |           |         |       |           |           |
| inte      |           |         |       |           |           |
| nsivement |           |         |       |           |           |
| avec      |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| > l'ut    |           |         |       |           |           |
| ilisateur |           |         |       |           |           |
| > (avec   |           |         |       |           |           |
| > d       |           |         |       |           |           |
| ifférents |           |         |       |           |           |
| >         |           |         |       |           |           |
|  réglages |           |         |       |           |           |
| > et      |           |         |       |           |           |
| > *c      |           |         |       |           |           |
| onsignes* |           |         |       |           |           |
| > po      |           |         |       |           |           |
| ssibles). |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
|           |           |         | /     |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| *•*       |           |         | A     |           |           |
| L         |           |         |       |           |           |
| 'objectif |           |         |       |           |           |
| global de |           |         |       |           |           |
| ce        |           |         |       |           |           |
| système   |           |         |       |           |           |
| temps     |           |         |       |           |           |
| réel      |           |         |       |           |           |
| embarqué  |           |         |       |           |           |
| est de    |           |         |       |           |           |
| maintenir |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+
| la        |           |         |       |           |           |
| te        |           |         |       |           |           |
| mpérature |           |         |       |           |           |
| et la     |           |         |       |           |           |
| pression  |           |         |       |           |           |
| d'un      |           |         |       |           |           |
| certain   |           |         |       |           |           |
| processus |           |         |       |           |           |
| chimique  |           |         |       |           |           |
| dans des  |           |         |       |           |           |
+-----------+-----------+---------+-------+-----------+-----------+

+---+------+---+
|   | > A\ |   |
|   | > /\ |   |
|   | > D  |   |
+---+------+---+

+---+------+---+
|   | > A\ |   |
|   | > /\ |   |
|   | > D  |   |
+---+------+---+

  -- --
     
     
  -- --

> limites déﬁnies.

*•* Un vrai système de ce type serait clairement plus complexe,
permettant par exemple à l'opérateur de modiﬁer les

> limites (consignes).

*•* Le but de ce système est de conserver la température et la pression
d'un processus chimique dans des limites

> spéciﬁées.
>
> *•* Un vrai système sera plus complexe, par exemple, permettre à un
> opérateur de modiﬁer ces limites.
>
> *•* Deux approches : synchrone (cyclique) et asynchrone.
>
> T : Thermocouple\
> P : Pression\
> S : Écran (screen)\
> *•* On distingue plusieurs entités concurrentes :
>
> *◦* Gestionnaire de la température (T)
>
> *◦* Gestionnaire de la pression(P)
>
> *◦* Gestionnaire du Chauffage
>
> *◦* Gestionnaire de la Pompe
>
> *◦* La tâche Ecran (S)
>
> *◦* Un contrôleur pour coordonnée l'ensemble
>
> *•* Par ailleurs, nous utiliserons une zone mémoire partagée pour \...
>
> et protégée par un verrou (un sémaphore est également possible).
>
> Réalisation d'une système muti-tâche de contrôle de Température et
> Pression \#3
>
> **Tâche Contrôleur :**\
> Répéter toutes les *X* secondes

+----------------+----------------+----------------+----------------+
| >              | > ve           | > **Tâche      |                |
| **Déclarations | rrouiller(Ver) | > Chauffage    |                |
| > :**          | > ;            | > :**          |                |
+================+================+================+================+
| > Ver : Verrou | > *T ← MemT*   | > *P ← MemP*   |                |
| > -- cf. TAS   |                |                |                |
+----------------+----------------+----------------+----------------+
| > Seuil_T,     | > libérer(Ver) |                |                |
| > Seuil_P :    | > ;            |                |                |
| > réel *←* ..  |                |                |                |
+----------------+----------------+----------------+----------------+
|                | > Si (*T \>    |                |                |
|                | > Seuil*\_*T*) |                |                |
+----------------+----------------+----------------+----------------+
| > go_pompe :   |                |                |                |
| > bool *←*     |                |                |                |
| > faux         |                |                |                |
+----------------+----------------+----------------+----------------+
|                | > go_chauffage | > -- pour le   |                |
|                | > *←* faux     | > chauffage    |                |
+----------------+----------------+----------------+----------------+
| > go_chauffage |                |                | > Répéter      |
| > : bool *←*   |                |                | > toutes les   |
| > faux         |                |                | > *Z* secondes |
+----------------+----------------+----------------+----------------+
|                | > Si (*P \>    |                |                |
|                | > Seuil*\_*P*) |                |                |
+----------------+----------------+----------------+----------------+
| > *mem*\_*xx*  |                | Si             |                |
| > : mémoire    |                | (go_chauffage) |                |
| > partagée     |                | Alors          |                |
+----------------+----------------+----------------+----------------+
| > ---------    | > go_pompe *←* | > -- pour la   |                |
| -------------- | > vrai         | > Pompe        |                |
| -------------- |                |                |                |
+----------------+----------------+----------------+----------------+
|                |                |                | \"mettre en    |
|                |                |                | route\"        |
+----------------+----------------+----------------+----------------+
|                | > Sinon        |                |                |
|                | > go_pompe *←* |                |                |
|                | > faux         |                |                |
+----------------+----------------+----------------+----------------+
| > mémoire      |                | Sinon          |                |
| > partagée :   |                | \"arrêter\"    |                |
+----------------+----------------+----------------+----------------+
|                | > Sinon Si (*T |                |                |
|                | > \<           |                |                |
|                | > Seuil*\_*T*) |                |                |
+----------------+----------------+----------------+----------------+
|                |                | Fin si         |                |
+----------------+----------------+----------------+----------------+
| si *thread*    | > go_pompe *←* |                |                |
| (ou task ADA)  | > vrai         |                |                |
| utilisés alors |                |                |                |
+----------------+----------------+----------------+----------------+
| > une variable |                | > Fin Répéter  |                |
| > globale si   |                |                |                |
| > non un       |                |                |                |
| > *shmem*.     |                |                |                |
+----------------+----------------+----------------+----------------+
|                | > go_chauffage |                |                |
|                | > *←* vrai     |                |                |
+----------------+----------------+----------------+----------------+
| ¥ Certains     |                |                |                |
| langages       |                |                |                |
| proposent des  |                |                |                |
| va-            |                |                |                |
+----------------+----------------+----------------+----------------+
|                | Sinon          | -- *T* =       |                |
|                |                | *Seuil*\_*T*   |                |
+----------------+----------------+----------------+----------------+
| riables        | > go_chauffage |                |                |
| **protégées**  | > *←* faux     |                |                |
| = variable     |                |                |                |
| globale +      |                |                |                |
+----------------+----------------+----------------+----------------+
| > Verrou mutex |                |                |                |
+----------------+----------------+----------------+----------------+
|                | > Si (*P \>    |                |                |
|                | > Seuil*\_*P*) |                |                |
|                | > go_pompe *←* |                |                |
|                | > vrai         |                |                |
+----------------+----------------+----------------+----------------+
|                | > Sinon        |                |                |
|                | > go_pompe *←* |                |                |
|                | > faux         |                |                |
+----------------+----------------+----------------+----------------+
|                | > Fin Répéter  |                |                |
+----------------+----------------+----------------+----------------+

> *•* En général, le contrôleur crée les tâches après sa propre
> création.

+----------------+----------------+----------------+----------------+
| > **Tâche      | > **Tâche      | > **Tâche      | > **Tâche      |
| > Température  | > Pression :** | > Pompe :**    | > Ecran :**    |
| > :**          |                |                |                |
+================+================+================+================+
| > Répéter      | > Répéter      | Répéter toutes | > Répéter      |
| > toutes les   | > toutes les   | les *Z*        |                |
| > *S* secondes | > *U* secondes | secondes       |                |
+----------------+----------------+----------------+----------------+
| lire la valeur | > lire la      | > Si           | ve             |
| *V* sur le     | > valeur *V*   | > (go_pompe)   | rrouiller(Ver) |
| capteur        | > sur le       | > Alors        | ;              |
|                | > capteur      |                |                |
+----------------+----------------+----------------+----------------+
| > Co           | > Co           | > \"mettre en  | > *T ← MemT*   |
| nvertir_AD(*V* | nvertir_AD(*V* | > route\"      |                |
| > ,*T*)        | > ,*P*)        |                |                |
+----------------+----------------+----------------+----------------+
| > ve           | > ve           | > Sinon        | > *P ← MemP*   |
| rrouiller(Ver) | rrouiller(Ver) | > \"arrêter\"  |                |
| > ;            | > ;            |                |                |
+----------------+----------------+----------------+----------------+
| > Ecr          | > Ecr          | > Fin si       | > libérer(Ver) |
| ire(*T*,*MemT* | ire(*P*,*MemP* |                | > ;            |
| > )            | > )            |                |                |
+----------------+----------------+----------------+----------------+
| > libérer(Ver) | > libérer(Ver) | > Fin Répéter  | > écrire *T*   |
| > ;            | > ;            |                | > et *P*       |
+----------------+----------------+----------------+----------------+
| > Fin Répéter  | > Fin Répéter  |                | > Fin Répéter  |
+----------------+----------------+----------------+----------------+

*•* La gestion par les booléennes *go_pompe, go_chauffage* peut être
remplacée par le mécanisme d'évènement (*Attendre,*

> *Signaler*) :
>
> ¥ la tâche Pompe fera *Attendre(go_pompe)* conjugué avec
> *Signaler(go_pompe)* effectué par le Contrôleur.
>
> *•* Ces booléennes n'ont pas besoin d'un accès en *mutex* car le
> *contrôleur* y écrit et Pompe (ou Chauffage) lisent.

+-------------------------------+-------------------------------+---+
| > Simulation des déplacements | \#4                           |   |
| > d'un Robot                  |                               |   |
+===============================+===============================+===+
| > III                         | > Simulation des déplacements |   |
|                               | > d'un Robot                  |   |
+-------------------------------+-------------------------------+---+
| > Difﬁculté :                 |                               |   |
| > \*\*\*/\*\*\*\*\* , **(5    |                               |   |
| > points)**                   |                               |   |
+-------------------------------+-------------------------------+---+

  --
  --

> La partie graphique doit impérativement être réalisée sous
> **TkInter**. Les versions qui existent sur le WEB ne sont
>
> pas acceptées (ne sont pas réalisées avec Tkinter) !
>
> *•* Un robot avec les caractéristiques suivants
>
> --- Pas de but particulier : avancer et éviter les obstacles
>
> --- Plusieurs capteurs : infra rouge (IR) sur les 2 côtés, sonar (US)
> frontal, de contact (Bumper) frontal
>
> --- Les actions sur les servo moteurs : *avancer*, *reculer*, *tourner
> à gauche/droite*
>
> --- Le comportement par défaut est : *avancer*
>
> --- Un écran d'afﬁchage de l'état
>
> *•* Principes : lecture des capteurs
>
> **Tâche Controleur :**\
> Répéter toutes les *X* secondes

+----------------------+----------------------+----------------------+
| > **Déclarations :** | > Commande *←*       | > **Tâche Ecran :**  |
|                      | > \"avancer\"        |                      |
+======================+======================+======================+
|                      | > Drapeau *←* faux   |                      |
+----------------------+----------------------+----------------------+
| > Ver : Verrou --    | > Si (Drapeau_IR)    |                      |
| > cf. TAS            | > Alors              |                      |
+----------------------+----------------------+----------------------+
| > les Distances :    | > Commande *←*       |                      |
| > réel *←* ..        | > Cmd_IR             |                      |
+----------------------+----------------------+----------------------+
|                      | > Drapeau *←*        |                      |
|                      | > Drapeau_IR         |                      |
+----------------------+----------------------+----------------------+
| > les Drepeaux :     |                      | > Répéter tou sles   |
| > bool *←* faux      |                      | > *A* secondes       |
+----------------------+----------------------+----------------------+
|                      | > Si (Drapeau_US)    |                      |
|                      | > Alors              |                      |
+----------------------+----------------------+----------------------+
| > *mem*\_*xx* :      |                      | > verrouiller(Ver) ; |
| > mémoire partagée   |                      |                      |
+----------------------+----------------------+----------------------+
| > -----------------  | > Commande *←*       |                      |
| -------------------- | > Cmd_US             |                      |
+----------------------+----------------------+----------------------+
|                      |                      | > *C ← mem*\_*Cmd*   |
+----------------------+----------------------+----------------------+
|                      | > Drapeau *←*        |                      |
|                      | > Drapeau_US         |                      |
+----------------------+----------------------+----------------------+
| > mémoire partagée : |                      | > *F ← mem*\_*Flag*  |
+----------------------+----------------------+----------------------+
|                      | > Si (Drapeau_BU)    |                      |
|                      | > Alors              |                      |
+----------------------+----------------------+----------------------+
| > si *thread* (ou    |                      | > libérer(Ver) ;     |
| > task ADA) utilisés |                      |                      |
| > alors              |                      |                      |
+----------------------+----------------------+----------------------+
|                      | > Commande *←*       |                      |
|                      | > Cmd_BU             |                      |
+----------------------+----------------------+----------------------+
| > une variable       |                      | > écrire *C* et *F*  |
| > globale si non un  |                      |                      |
| > *shmem*.           |                      |                      |
+----------------------+----------------------+----------------------+
|                      | > Drapeau *←*        |                      |
|                      | > Drapeau_BU         |                      |
+----------------------+----------------------+----------------------+
| > ¥ Certains         |                      | > Fin Répéter        |
| > langages proposent |                      |                      |
| > des va-            |                      |                      |
+----------------------+----------------------+----------------------+
|                      | > Transmettre        |                      |
|                      | > *Commande* aux     |                      |
|                      | > servos             |                      |
+----------------------+----------------------+----------------------+
| > riables            | > verrouiller(Ver) ; |                      |
| > **protégées** =    |                      |                      |
| > variable globale + |                      |                      |
+----------------------+----------------------+----------------------+
| > Verrou mutex       | > *mem*\_*Cmd ←      |                      |
|                      | > Commande*          |                      |
+----------------------+----------------------+----------------------+
|                      | > *mem*\_*Flag ←     |                      |
|                      | > Drapeau*           |                      |
+----------------------+----------------------+----------------------+
|                      | > libérer(Ver) ;     |                      |
+----------------------+----------------------+----------------------+

Fin Répéter

> *•* En général, le contrôleur crée les tâches après sa propre
> création.
>
> Simulation des déplacements d'un Robot \#5

**Tâche US :**

+----------------------------------+----------------------------------+
| > **Tâche IR :**                 | > Répéter toutes les *K*         |
|                                  | > secondes                       |
+==================================+==================================+
| > Répéter toutes les *S*         | lire la valeur *V* sur le        |
| > secondes                       | capteur                          |
+----------------------------------+----------------------------------+
| > lire la valeur *V g* sur le    | Convertir_AD(*V* ,*D*)           |
| > capteur gauche                 |                                  |
+----------------------------------+----------------------------------+
| > lire la valeur *V d* sur le    | Si *D \< d* Alors                |
| > capteur droit                  |                                  |
+----------------------------------+----------------------------------+
| > Convertir_AD(*V g*,*Dg*)       | Drapeau_US *←* vrai              |
+----------------------------------+----------------------------------+
| > Convertir_AD(*V d*,*Dd*)       | Cmd_US *←* \"reculer\"           |
+----------------------------------+----------------------------------+
| > Si *Dg \< d* OU *Dd \< d*      | Sinon Drapeau_US *←* faux        |
| > Alors                          |                                  |
+----------------------------------+----------------------------------+
| > Drapeau_IR *←* vrai            | > Fin Répéter                    |
+----------------------------------+----------------------------------+
| > Si *Dg \< d* ET *Dd \< d*      | > **Tâche Bumper :**             |
| > Alors                          |                                  |
+----------------------------------+----------------------------------+
| Cmd_IR *←* \"reculer\"           |                                  |
+----------------------------------+----------------------------------+
| > Sinon Si *Dg \< d* Alors       | > Répéter toutes les *Z*         |
|                                  | > secondes (*Z* petit)           |
+----------------------------------+----------------------------------+
| Cmd_IR *←* \"à gauche\"          | Si (contact=1) Alors             |
+----------------------------------+----------------------------------+
| Sinon Cmd_IR *←* \"à droite\"    | Drapeau_BU *←* vrai              |
+----------------------------------+----------------------------------+
| > Sinon Drapeau_IR *←* faux      | Cmd_BU *←* \"reculer\"           |
+----------------------------------+----------------------------------+
| > Fin Répéter                    | Sinon Drapeau_BU *←* faux        |
+----------------------------------+----------------------------------+
|                                  | > Fin Répéter                    |
+----------------------------------+----------------------------------+

> **Remarque** sur \"Répéter toutes les *X* milli/micro/nanosecondes\" :
>
> Un moyen simple d'implanter ce délai :\
> Next *←* temps actuel (clock)
>
> Répéter\
> Actions
>
> *Next ← Next* + *X*
>
> *delay* until next
>
> Fin Répéter
>
> *•* Si *delay* non disponible :
>
> Temps *←* temps actuel (clock)
>
> Répéter\
> Actions\
> Next *←* temps actuel (clock)
>
> Reste *←* X - (Next - Temps)
>
> Attendre(Reste) -- e.g. usleep/sleep\
> Temps *←* Next
>
> Fin Répéter\
> ¥ Bien entendu, *Reste \>* 0 sinon, le système n'est pas RT ! !
>
> Simulation des déplacements d'un Robot \#6
>
> Un système muti-tâches de simulation d'un restaurant

  --
  --

> Difﬁculté : \*\*/\*\*\*\*\* , **(5 points)**
>
> On considère le système (*temps réel*) simple suivant qui :
>
> 1\. simule des commandes de clients dans un restaurant
>
> 2\. un certains nombre de serveurs en salle enregistrent ces commandes
> et les transmettent à la cuisine pour pré- paration
>
> 3\. après leur préparation, les serveurs délivrent ces commandes aux
> clients

**Dans la version de base**, on n'identiﬁe pas de cuisinier et ce sont
les serveurs qui simulent la préparation des com-

> mandes (voir plus bas pour la version étendue).\
> **Prévoir :**
>
> *◦ s* processus *serveur*. P. Ex. *s* = 5
>
> *◦* un processus *clients* qui simulera aléatoirement les commandes
> des clients selon une loi uniforme. Ce processus
>
> émettra une commande aléatoire toutes les p. ex. 3*..*10 *secondes* à
> l'adresse des serveurs.
>
> *◦* un processus *major_dHomme* qui s'occupera des afﬁchages à l'écran
>
> *◦* un tampon de taille (p. ex.) 50 contiendra les commandes des
> clients ; les serveurs prélèvent des commandes de
>
> ce tableau
>
> *◦* une commande d'un client sera constituée d'un identiﬁant client
> (un entier) et une lettre *A..Z* qui représentera
>
> le menu commandé

En l'absence d'interface graphique, on utilisera le module **curses** de
Python que l'on a déjà utilisé dans l'exemple

> cours de chevaux. On afﬁchera ainsi à l'écran les informations
> suivants :
>
> *◦* les commandes des clients (les paires *(id, menu)*) dès leur
> émission
>
> *◦* le serveur qui prend cette commande en charge et simule sa
> préparation (par un délai)
>
> *◦* le client qui reçoit sa commande préparée
>
> Les informations sont afﬁchées exclusivement par le processus
> *major_dHomme*.
>
> Un exemple d'afﬁchage à l'écran :

+----------------------------------------------------------------------+
| > **Le serveur** 1 **traite la commande** (*idi, Ci*) (ou rien si    |
| > pas de commande traité par ce serveur)                             |
| >                                                                    |
| > \....                                                              |
| >                                                                    |
| > **Le serveur** *s* **traite la commande** (*idj, Cj*)              |
| >                                                                    |
| > **Les commandes clients en attente : \[**(*idi, Ci*) **,** (*idj,  |
| > Cj*) **\...**(*idk, Ck*) **\]**                                    |
| >                                                                    |
| > **Nombres de commandes attente :** 5                               |
| >                                                                    |
| > **Commande** (*idu, U*) **est servie au client**                   |
+----------------------------------------------------------------------+

> Simulation des déplacements d'un Robot \#7
>
> **Aller plus loin (Bonus) :**
>
> Ajouter un certains nombre de cuisiniers (en cuisine) qui préparent
> ces commandes et avertissent les serveurs. Leserveur qui avait
> enregistré la commande la délivre au client qui a commandée.
>
> **Ajouter à l aversion de base :**
>
> *◦ c* processus *cuisto*. P. Ex. *c* = 2
>
> *◦* Modiﬁer les afﬁchage et présenter le cuisinier qui traite la
> commande.
>
> Le contenu de l'écran sera augmenté des lignes :
>
> **Le cuisiner** 1 **prépare la commande** (*id*1*, A, serveur*1) (ou
> rien si pas de commande traité par ce cuisinier)
>
> \....
>
> **Le cuisiner** *c* **prépare la commande** (*idp, P, serveurp*)

+------------------------------------------------+----------------+---+
| > Game of Life                                 | \#8            |   |
+================================================+================+===+
| > IV                                           | > Game of Life |   |
+------------------------------------------------+----------------+---+
| > Difﬁculté : \*\*/\*\*\*\*\* , **(5 points)** |                |   |
+------------------------------------------------+----------------+---+

  --
  --

Réaliser le jeu suivant dans une version **concurrente** avec les
mécanismes de base graphique (*screen* comme dans la

> course Hippique).
>
> Il s'agit d'une grille (matrice de taille d'au moins 15*x*15) dont les
> cases représentent soit un \"être\" vivant soit rien.L'état d'une case
> peut être modiﬁé en fonction de son voisinage selon les règles
> décrites ci-dessous.
>
> [Extrait de l'énoncé d'origine :]{.ul}\
> *•* The universe of the Game of Life is an inﬁnite two-dimensional
> orthogonal grid of square cells, each of which is in
>
> one of two possible states, alive or dead.

*•* Every cell interacts with its eight neighbours, which are the cells
that are horizontally, vertically, or diagonally

> adjacent. At each step in time, the following transitions occur :
>
> *◦* Any live cell with fewer than two live neighbours dies, as if
> caused by under-population.
>
> *◦* Any live cell with two or three live neighbours lives on to the
> next generation.
>
> *◦* Any live cell with more than three live neighbours dies, as if by
> overcrowding.
>
> *◦* Any dead cell with exactly three live neighbours becomes a live
> cell, as if by reproduction.
>
> *•* The initial pattern constitutes the seed of the system.

*•* The ﬁrst generation is created by applying the above rules
simultaneously to every cell in the seed-births and deaths

> occur simultaneously, and the discrete moment at which this happens is
> sometimes called a tick (in other words, eachgeneration is a pure
> function of the preceding one).
>
> *~~•~~* The rules continue to be applied repeatedly to create further
> generations.
>
> ASG, Novembre 2021
